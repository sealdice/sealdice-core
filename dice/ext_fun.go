package dice

import (
	wr "github.com/mroth/weightedrand"
	"math/rand"
	"time"
)

var gugu = []string{
	"æˆ‘å°½é‡8ç‚¹åŠå°±åˆ°  ä½†æ˜¯æ˜å¤©æœ‰äººè¦çº¦æˆ‘åƒé¥­â€¦â€¦",
	"å…ˆè¯´ä¸‹ï¼Œæ™šä¸Šå…ˆå»çœ‹ä¸ˆæ¯å¨˜ï¼Œç„¶åå›æ¥",
	"æ­£å¸¸å§ï¼Œæˆ‘çš„å·¥ä½œæƒ³ä¸å’•æ˜¯ä¸å¯èƒ½çš„å•Šï¼Œåªèƒ½è¯´æå‰æ‰“ä¸ªæ‹›å‘¼ã€‚",
	"ä»¥åéƒ½è¦ä¸Šå¤œç­äº†ï¼Œçªç„¶å®‰æ’æˆ‘çš„ï¼Œæœ¬æ¥ä¹Ÿä¸çŸ¥é“",
	"å¡è¿˜æ²¡è½¦å¥½ï¼Œè¦ä¸æˆ‘ä¸‹å‘¨æ¥å§",
	"ä½ ä»¬å…ˆç©ï¼Œæˆ‘èººç€çœ¯ä¸€ä¼šå„¿ï¼Œæœ‰ç‚¹ç´¯ï¼Œæ²¡äº‹å„¿ä½ ä»¬å…ˆç©ï¼Œæˆ‘èººç€æ’ä¸¤å¥å°±è¡Œ",
	"å¼€çš„è¯ï¼Œä½ ä»¬å…ˆç©ï¼Œæˆ‘åŠå¥½äº‹ï¼Œå°±æ¥ï¼Œå…ˆå’•ä¸ºæ•¬",
	"ä»Šå¤©å°±å’•äº†ï¼Œæ˜å¤©è€ƒè¯•ï¼Œè¦èƒŒé¢˜",
	"â€¦â€¦ä»Šå¤©å»åŒ»é™¢æŸ¥å‡ºè‚è™šï¼Œä¸èƒ½ç†¬å¤œäº†ã€‚åªèƒ½å›´è§‚äº†ã€‚",
	"æˆ‘åœ¨å¤–é¢åƒé¥­",
	"æˆ‘æ„Ÿå†’åŠ é‡äº†ï¼Œåº”è¯¥æ˜¯ä¸­è¯åƒåäº†",
	"ä»Šæ™šè¦å’•å’•å’•äº†å—ï¼Œä¸å¦‚å…ˆå»æ‰“å‡ å±€æ¸¸æˆ",
	"æˆ‘ä»Šå¤©åº”è¯¥ä¸è¡Œäº†~æ™šä¸Šæœ‰äº‹~",
	"å’•å’•å’•ï¼Œè¿™æ®µæ—¶é—´çœ¼ç›æ‚£äº†ç»“è†œç‚ï¼Œå›å½’æ—¥å¾…å®š",
	"åŠ ç­ï¼Œå›æ¥è¿Ÿ",
	"233ä»Šå¤©ä¼¼ä¹æœ‰ç‚¹äº‹æƒ…ï¼Œå¯èƒ½ä¼šæ™š",
	"æ—©ä¸Šå‘ç”Ÿäº†åœ°éœ‡ï¼Œè¦å»åŒ…çš„æ‘é‡ŒæŸ¥çœ‹ç¾æƒ…",
	"ååˆ†é’Ÿåˆ°å®¶ã€‚ä¸åƒçº¢ç¯çš„è¯",
	"å’ŒåŒäº‹åƒé¥­ï¼Œåº”è¯¥ä¸ä¼šæ™šå¤ªå¤šå§ï¼Œæˆ‘äº‰å–8.30",
	"é¥­å±€ï¼Œä½ ä»¬å…ˆå¼€èµ°å‰§æƒ…ï¼Œæˆ‘å°±åˆ°äº†",
	"DMä¸Šç­ç´¯ä¸ç´¯å•Šï¼Ÿæ™šä¸Šéœ€è¦ä¼‘æ¯å˜›ï¼Ÿæˆ‘å°±é—®é—®ï¼Œå…³å¿ƒä¸‹DMçš„å¥åº·ï¼Œæ²¡å…¶ä»–æ„æ€ï¼ŒçœŸçš„ï¼Œå’•å’•å’•ã€‚",
	"ä½ ä»¬çš„dmåœ¨å¤–å‡ºå–æï¼Œä»Šæ™šå’•äº†",
	"ä»Šå¤©å¯èƒ½ä¼šé¸½ä¸€ä¸‹ï¼Œä¸€ç›´åœ¨å¤–é¢å­¦ä¹ ï¼Œå¤©å¤©å­¦åˆ°ä¹ç‚¹å¤š",
	"æ™šä¸Šè¦åŠ ç­å¾ˆæ™šï¼Œæ¥ä¸äº†",
	"æˆ‘ä»Šå¤©è¦æ™šäº›ï¼Œå·¥ä½œæœ‰å˜åŠ¨",
	"ä»Šå¤©æˆ‘å¯èƒ½æ™šä¸Šggäº†ï¼Œåœ¨å±±é‡Œå€¼ç­ï¼Œä¿¡å·ä¸å¥½",
	"æˆ‘è¿™è¾¹è¦æ™šä¸€ç‚¹åˆ°ï¼Œçªç„¶è¢«åŒäº‹å«å»åƒé¥­äº†",
	"æˆ‘è¿™è·¯ä¸Šæœ‰ç‚¹å µè½¦ä¸è¿‡é©¬ä¸Š",
	"åŒå¿—ä»¬å¯¹ä¸ä½ï¼Œå·¥ä½œåŸå› å¼€å›¢è¦æš‚åœä¸¤å‘¨",
	"æ˜ŸæœŸä¸€é›†ä½“æ—…æ¸¸å’•å’•å’•ã€‚ã€‚",
	"ç®—æˆ‘ç®—æˆ‘ï¼Œå¿˜è®°äº†",
	"æ˜å¤©æˆ‘åŠ ç­ï¼Œä¸çŸ¥é“èƒ½ä¸èƒ½æ¥",
	"å‡ºå»æµªäº†ï¼Œå¯èƒ½å›æ¥æ™šç‚¹",
	"ä»Šæ™šå¤§å®¶æ˜¯ä¸æ˜¯éƒ½è¦å’•å’•å’•å‘¢ï¼Ÿ",
	"ç”µè„‘æ‰è£…å¥½ï¼Œæ™šä¸Šè¦ä¸è¦å’•å’•å’•",
	"é‚£ä¹ˆï¼Œæˆ‘å’ŒXXé¢„è®¡å’•ä¸€ä¸ªä¹Ÿæœ‰4ä¸ªäºº",
	"ä¸€ä¸ªé—®é¢˜ï¼Œï¼Œå‡ºå»æ‰¹å†°æ£’å¿˜å¸¦é’¥åŒ™äº†",
	"è¿™ä¹ˆæ—©[æ–œçœ¼ç¬‘]ä¸åƒä¸ªé¥­ï¼Œç¡ä¸€ä¼š",
	"å®¶é‡Œæœ‰äººï¼Œè¯­éŸ³çš„è¯è¿˜æ˜¯å¤ªç¾è€»äº†",
	"æ™šä¸Šå‡ ç‚¹ï¼Œè¿˜æ˜¯ç›´æ¥ä¸‹å‘¨",
	"è¿™ä¸ªæœˆå©šåº†ä¸´è¿‘å¯èƒ½å’•å’•å’•",
	"æ˜å¤©æˆ‘ä¹Ÿä¸çŸ¥é“èƒ½ä¸èƒ½è·‘ï¼Œè¦åŠ ç­",
	"çœ¼é•œæ‰äº†ï¼Œé…ä¸ªçœ¼é•œã€‚å¯èƒ½è¦æ™šç‚¹",
	"æˆ‘æ˜å¤©åº”è¯¥ä¸èƒ½æ¥ï¼Œæ˜ŸæœŸä¸€æœ‰ä¸ªè€ƒè¯•ï¼Œéœ€è¦èƒŒä¸‹é¢˜",
	"æˆ‘ä»Šå¤©å¯èƒ½ä¼šæ™š~å……ç”µçº¿æˆ–è€…æ‰‹æœºåäº†æ˜¨å¤©æ™šä¸Šæ²¡å……ä¸Šç”µ",
	"æˆ‘è¿˜åœ¨å¤–é¢ï¼Œä¼°è®¡è¿˜è¦1å°æ—¶",
	"æˆ‘ä»Šå¤©å‡†æ—¶åˆ°ï¼Œä½ ç»™ä»€ä¹ˆå¥–åŠ±",
	"è¿™å‘¨ä¸è·‘å§ï¼Œæˆ‘è¢«æ™’ä¼¤äº†ï¼Œä¼‘æ¯ä¸€å‘¨",
	"åº”è¯¥è½®åˆ°æˆ‘åŠ ç­å•Šï¼Œæˆ‘è¦çœ‹æƒ…å†µæ‰çŸ¥é“èƒ½æ¥ä¸",
	"æˆ‘å’ŒåŒäº‹å»åƒä¸ªé¥­ï¼Œå¯èƒ½ä¼šæ™šç‚¹ã€‚",
	"è¦å‡†å¤‡è€ƒè¯•ï¼Œæ˜ŸæœŸä¸€æ¥ä¸äº†",
	"æˆ‘çš„å·¥ä½œä½ åˆ«é—®ï¼Œä¸èƒ½è¯´ï¼Œæˆ‘ä»¬å¹²å·¥ä½œéœ€è¦å‘ä½ è§£é‡Šä¹ˆï¼Ÿ",
	"ä¸‹å‘¨æˆ‘å¯èƒ½ä¸´æ—¶åŠ ä¸€èŠ‚è¯¾",
	"é‚£æˆ‘å»ä¹°ç‚¹ä¸œè¥¿ï¼Œæ¥å¾—åŠèµ¶å›æ¥ï¼Œä¹Ÿè®¸",
	"åœ¨åœ°é“ä¸Šï¼Œè¯´è¯å®åœ¨æ˜¯ä¸å¤ªæ–¹ä¾¿~",
	"ä»Šæ™šçœ‹çƒï¼Œè¯·å‡ï¼Œå’•å’•å’•",
	"ä»Šå¤©å¯èƒ½ä¼šè¿Ÿåˆ° ä½ ä»¬å…ˆå¼€ç€ã€‚",
	"æˆ‘çœ‹çœ‹å§ï¼Œå¯èƒ½ä¸èƒ½è¯´è¯",
	"æœ¬å‘¨ä¸‰é™ªè€å©†å‡ºå»é€›åƒï¼Œé¢„è®¡ä¸¤å¤©",

	"æˆ‘æœ‰ç‚¹äº‹ï¼Œä½ ä»¬å…ˆå¼€",
	"æˆ‘å®¶çŒ«ç”Ÿç—…äº†ï¼Œå¸¦ä»–å»çœ‹ç—…",
	"åŒ»ç”Ÿè¯´ä»Šå¤©ç–«è‹—åˆ°äº†ï¼Œå¸¦çŒ«æ‰“ç–«è‹—",
	"æˆ‘é¸½æŸäººä»Šå¤©å°±æ˜¯è¦å’•å£ç‰™ï¼",
	"å½“ä½ ä»¬éƒ½è§‰å¾—æˆ‘è¦å’•çš„æ—¶å€™ï¼Œæˆ‘å’•äº†ï¼Œè¿™å…¶å®æ˜¯ä¸€ç§ä¸å’•",

	"è¯´å’•å°±å’•æ€ä¹ˆèƒ½ç®—æ˜¯å’•å’•äº†å‘¢ï¼",
}

func RegisterBuiltinExtFun(self *Dice) {
	choices := []wr.Choice{}
	for _, i := range gugu {
		choices = append(choices, wr.Choice{Item: i, Weight: 1})
	}
	guguRandomPool, _ := wr.NewChooser(choices...)

	cmdGugu := CmdItemInfo{
		Name:  "gugu",
		Brief: "è·å–ä¸€ä¸ªéšæœºçš„å’•å’•ç†ç”±",
		Solve: func(ctx *MsgContext, msg *Message, cmdArgs *CmdArgs) CmdExecuteResult {
			if ctx.IsCurGroupBotOn || msg.MessageType == "private" {
				//p := getPlayerInfoBySender(session, msg)
				rand.Seed(time.Now().UTC().UnixNano()) // always seed random!
				ReplyToSender(ctx, msg, "ğŸ•Šï¸: "+guguRandomPool.Pick().(string))
			}
			return CmdExecuteResult{Success: true}
		},
	}

	cmdJrrp := CmdItemInfo{
		Name:  "jrrp",
		Brief: "è·å¾—ä¸€ä¸ªD100éšæœºå€¼ï¼Œä¸€å¤©å†…ä¸ä¼šå˜åŒ–",
		Solve: func(ctx *MsgContext, msg *Message, cmdArgs *CmdArgs) CmdExecuteResult {
			if msg.MessageType == "group" {
				if ctx.IsCurGroupBotOn {
					p := ctx.Player
					todayTime := time.Now().Format("2006-01-02")

					rp := 0
					if p.RpTime == todayTime {
						rp = p.RpToday
					} else {
						rp = DiceRoll(100)
						p.RpTime = todayTime
						p.RpToday = rp
					}

					VarSetValue(ctx, "$täººå“", &VMValue{VMTypeInt64, int64(rp)})
					ReplyGroup(ctx, msg.GroupId, DiceFormatTmpl(ctx, "å¨±ä¹:ä»Šæ—¥äººå“"))
				}
			}
			return CmdExecuteResult{Success: true}
		},
	}

	self.ExtList = append(self.ExtList, &ExtInfo{
		Name:            "fun", // æ‰©å±•çš„åç§°ï¼Œéœ€è¦ç”¨äºæŒ‡ä»¤ä¸­ï¼Œå†™ç®€çŸ­ç‚¹
		Version:         "0.0.1",
		Brief:           "å¨±ä¹æ‰©å±•ï¼Œä¸»æ‰“æŠ½ç‰ŒåŠŸèƒ½ã€æ™ºèƒ½é¸½å­",
		AutoActive:      true, // æ˜¯å¦è‡ªåŠ¨å¼€å¯
		ActiveOnPrivate: true,
		Author:          "æœ¨è½",
		OnCommandReceived: func(ctx *MsgContext, msg *Message, cmdArgs *CmdArgs) {
			//p := getPlayerInfoBySender(session, msg)
			//p.TempValueAlias = &ac.Alias;
		},
		OnLoad: func() {
		},
		GetDescText: func(i *ExtInfo) string {
			return "> " + i.Brief + "\n" + "æä¾›å‘½ä»¤:\n.gugu / .å’•å’•  // è·å–ä¸€ä¸ªéšæœºçš„å’•å’•ç†ç”±\n.jrrp ä»Šæ—¥äººå“"
		},
		CmdMap: CmdMapCls{
			"gugu": &cmdGugu,
			"å’•å’•":   &cmdGugu,
			"jrrp": &cmdJrrp,
		},
	})
}
